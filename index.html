<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Alien Invasion â€” Arrival Manifest</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root{--bg:#030417;--card:rgba(255,255,255,0.03);--glass:rgba(255,255,255,0.04);--accent:#f6c2f3;--muted:rgba(255,255,255,0.72);--radius:12px}
    *{box-sizing:border-box}
    body{margin:0;min-height:100vh;font-family:Inter, system-ui, -apple-system, 'Orbitron', sans-serif;color:#eef2f7;background:#000;display:flex;align-items:center;justify-content:center}

    /* Background: blurred space image */
    .bg{position:fixed;inset:0;background-image:url('https://images.unsplash.com/photo-1444703686981-a3abbc4d4fe3?q=80&w=1600&auto=format&fit=crop&ixlib=rb-4.0.3&s=1b9f0ba7d7a1b1f9d6f4f0b2b3d6f6d1');background-size:cover;background-position:center;filter:blur(0px) brightness(0.42);z-index:0}

    .wrap{position:relative;z-index:2;padding:20px;width:100%;max-width:920px}
    .card{background:linear-gradient(180deg,var(--card),transparent);backdrop-filter:blur(3px);border-radius:var(--radius);padding:18px;border:1px solid rgba(255,255,255,0.04);box-shadow:0 12px 40px rgb(255, 197, 241)}

    h1{margin:0;font-family:'Orbitron',sans-serif;font-size:20px}
    p.lead{color:var(--muted);margin:6px 0 14px}

    form{display:grid;grid-template-columns:1fr 320px;gap:18px}
    .left{display:flex;flex-direction:column;gap:12px}
    label{font-size:13px;color:var(--muted);margin-bottom:6px}
    input[type=text], input[type=email], input[type=tel], textarea, select, input[type=date], input[type=number]{
      width:100%;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:#fff
    }
    textarea{min-height:100px}

    /* select and contact input styling: transparent background, visible text */
    select{background:transparent;color:#9c9999;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.06);-webkit-appearance:none;appearance:none}

    /* make inputs glow a little on focus */
    input:focus, textarea:focus, select:focus{outline:none;border-color:var(--accent);box-shadow:0 8px 30px rgba(125,249,255,0.12)}
    input::placeholder, textarea::placeholder{color:rgba(255,255,255,0.6)}

    .right{padding:12px;border-radius:10px;background:var(--glass);display:flex;flex-direction:column;gap:50px}
    /* increased photo preview height as requested */
    .photo-preview{height:520px;border-radius:8px;background:rgba(255,255,255,0.03);display:flex;align-items:center;justify-content:center;overflow:hidden;color:var(--muted);font-size:13px}
    .photo-preview img{width:100%;height:100%;object-fit:cover;border-radius:8px}

    .row{display:flex;gap:10px}
    .col{flex:1}
    .btn{padding:12px 16px;border-radius:10px;border:none;background:linear-gradient(90deg,var(--accent),#a27bff);color:#021;font-weight:700;cursor:pointer}
    .note{font-size:13px;color:var(--muted)}

    .hidden{display:none}

    /* success banner styles */
    .success-banner{position:fixed;top:18px;left:50%;transform:translateX(-50%) translateY(-8px);background:#b0f6ff;color:#04220b;padding:12px 18px;border-radius:8px;box-shadow:0 10px 30px rgba(0,0,0,0.35);opacity:0;pointer-events:none;transition:opacity 0.35s ease, transform 0.35s ease}
    .success-banner.show{opacity:1;transform:translateX(-50%) translateY(0);pointer-events:auto}

    @media (max-width:900px){form{grid-template-columns:1fr} /* note: image stays on right (no order change) */ }
  </style>
</head>
<body>
  <div class="bg" aria-hidden="true"></div>
  <div class="wrap">
    <div class="card" role="main">
      <h1>Alien Arrival â€” Manifest</h1>
      <p class="lead">Provide origin, mission purpose, ship ID and a photo. Simple, clear, and ready for reporting.</p>

      <form id="form" novalidate autocomplete="off">
        <div class="left">
          <div>
            <label for="fullname">Full name</label>
            <input id="fullname" name="fullname" type="text" placeholder="Commander Zex" required />
          </div>

          <div class="row">
            <div class="col">
              <label for="contactType">Preferred contact</label>
              <select id="contactType" name="contactType">
                <option value="">â€” choose contact â€”</option>
                <option value="phone">Phone</option>
                <option value="email">Mail</option>
                <option value="other">Other</option>
              </select>
            </div>
            <div style="width:140px">
              <label for="contactValue">Contact</label>
              <input id="contactValue" name="contactValue" type="text" placeholder="Select contact type" />
            </div>
          </div>

          <div>
            <label for="planet">Planet of origin</label>
            <select id="planet" name="planet" required>
              <option value="">â€” choose planet â€”</option>
              <option>Kepler-186f</option>
              <option>TRAPPIST-1e</option>
              <option>Proxima b</option>
              <option>Gliese 667 Cc</option>
              <option>Other</option>
            </select>
          </div>

          <div id="otherPlanetField" class="hidden">
            <label for="otherPlanet">Specify planet</label>
            <input id="otherPlanet" name="otherPlanet" type="text" placeholder="Name of planet" />
          </div>

          <!-- === ADDED FIELD: Planet Name (must contain at least one vowel and one digit) === -->
          <div>
            <label for="planetNameComplex">Planet name (must include at least one vowel and one digit)</label>
            <input id="planetNameComplex" name="planetNameComplex" type="text" placeholder="Elysium7" />
            <div class="note">Example: <code>Elysium7</code> â€” contains vowels + digit.</div>
          </div>

          <!-- === ADDED FIELD: Antenna Count (even numbers only) === -->
          <div>
            <label for="antennaCount">Antenna count (even numbers only)</label>
            <input id="antennaCount" name="antennaCount" type="text" inputmode="numeric" placeholder="4" />
          </div>

          <!-- === ADDED FIELD: Alien ID === -->
          <div>
            <label for="alienId">Alien ID (format: ZOR-XY_9999@UFO)</label>
            <input id="alienId" name="alienId" type="text" placeholder="ZOR-AB_1234@UFO" />
            <div class="note">Strict format: 3 uppercase letters, dash, 2 uppercase letters, underscore, 4 digits, "@UFO".</div>
          </div>

          <!-- === ADDED FIELD: Favorite Human Phrase (must include emoji or punctuation) === -->
          <div>
            <label for="favPhrase">Favorite human phrase (must include an emoji or punctuation)</label>
            <input id="favPhrase" name="favPhrase" type="text" placeholder="Hello, world! ðŸ˜Š" />
            <div class="note">Include punctuation like <code>!</code>, <code>?</code>, or an emoji.</div>
          </div>

          <!-- === ADDED FIELD: Landing Date (cannot be in the past) === -->
          <div>
            <label for="landingDate">Landing date (cannot be in the past)</label>
            <input id="landingDate" name="landingDate" type="date" />
          </div>

          <!-- === ADDED: Creative extra field (Beacon Frequency) === -->
          <div>
            <label for="beaconFreq">Beacon Frequency (Hz) â€” optional</label>
            <input id="beaconFreq" name="beaconFreq" type="text" inputmode="numeric" placeholder="1420" />
            <div class="note">Use numeric frequency. Example: 1420 (21-cm hydrogen line)</div>
          </div>

          <div>
            <label for="region">Region / City (if known)</label>
            <input id="region" name="region" type="text" placeholder="Sector 7G, Southern Belt" />
          </div>

          <div>
            <label for="purpose">Purpose of visit</label>
            <select id="purpose" name="purpose" required>
              <option value="">â€” select purpose â€”</option>
              <option>Exploration</option>
              <option>Diplomacy</option>
              <option>Trade</option>
              <option>Scientific Research</option>
              <option>Resource Collection</option>
              <option>Other</option>
            </select>
          </div>

          <div id="otherPurposeMsg" class="hidden note">Please describe your purpose in the message field below.</div>

          <div>
            <label for="intent">Short statement (optional)</label>
            <textarea id="intent" name="intent" placeholder="We come to study your oceans..."></textarea>
          </div>

          <div class="row">
            <div class="col">
              <label for="ship">Ship name / Class</label>
              <input id="ship" name="ship" type="text" placeholder="Mothership IX" />
            </div>
            <div style="width:140px">
              <label for="reg">Ship registry ID</label>
              <input id="reg" name="reg" type="text" placeholder="RX-771" required />
            </div>
          </div>

          <div>
            <label for="crew">Crew size</label>
            <input id="crew" name="crew" type="text" inputmode="numeric" placeholder="12" />
          </div>

          <div>
            <button class="btn" type="submit">Send Manifest</button>
          </div>

          <div id="status" class="note" aria-live="polite"></div>
        </div>

        <div class="right">
          <div class="photo-preview" id="preview">No photo uploaded</div>
          <div>
            <label for="photo">Upload identity / ship image</label>
            <input id="photo" name="photo" type="file" accept="image/*" required />
          </div>

        </div>
      </form>
      <div id="successBanner" class="success-banner" aria-hidden="true"></div>
    </div>
  </div>

  <script>
    const form = document.getElementById('form');
    const preview = document.getElementById('preview');
    const photo = document.getElementById('photo');
    const status = document.getElementById('status');
    const purpose = document.getElementById('purpose');
    const otherPurposeMsg = document.getElementById('otherPurposeMsg');
    const planet = document.getElementById('planet');
    const otherPlanetField = document.getElementById('otherPlanetField');
    const contactType = document.getElementById('contactType');
    const contactValue = document.getElementById('contactValue');
    const successBanner = document.getElementById('successBanner');

    // small UX: enforce digits-only on crew input as-you-type
    const crewInput = document.getElementById('crew');
    crewInput.addEventListener('input', (e) => {
      // strip any non-digit
      const cleaned = e.target.value.replace(/\D+/g,'');
      if (e.target.value !== cleaned) e.target.value = cleaned;
    });

    // also enforce digits-only on antennaCount & beaconFreq as you type
    const antennaCountInput = document.getElementById('antennaCount');
    antennaCountInput.addEventListener('input', (e) => {
      const cleaned = e.target.value.replace(/\D+/g,'');
      if (e.target.value !== cleaned) e.target.value = cleaned;
    });
    const beaconFreqInput = document.getElementById('beaconFreq');
    beaconFreqInput.addEventListener('input', (e) => {
      const cleaned = e.target.value.replace(/\D+/g,'');
      if (e.target.value !== cleaned) e.target.value = cleaned;
    });

    // contact type handling â€” alienified placeholders
    contactType.addEventListener('change', ()=>{
      const val = contactType.value;
      contactValue.required = val !== '';
      if(val === 'phone'){
        contactValue.type = 'tel';
        contactValue.placeholder = '+ALIEN-0000';
      } else if(val === 'email'){
        contactValue.type = 'email';
        contactValue.placeholder = 'commander@alienism.space';
      } else if(val === 'other'){
        contactValue.type = 'text';
        contactValue.placeholder = 'provide cosmic contact';
      } else {
        contactValue.type = 'text';
        contactValue.placeholder = 'Select contact type';
      }
    });

    // show/hide "Other" inputs or messages
    purpose.addEventListener('change', ()=>{
      if(purpose.value === 'Other'){
        otherPurposeMsg.classList.remove('hidden');
      } else {
        otherPurposeMsg.classList.add('hidden');
      }
    });

    planet.addEventListener('change', ()=>{
      if(planet.value === 'Other'){
        otherPlanetField.classList.remove('hidden');
        document.getElementById('otherPlanet').required = true;
      } else {
        otherPlanetField.classList.add('hidden');
        document.getElementById('otherPlanet').required = false;
      }
    });

    // image preview
    photo.addEventListener('change', (e)=>{
      const file = e.target.files[0];
      if(!file) { preview.textContent = 'No photo uploaded'; return; }
      const reader = new FileReader();
      reader.onload = ()=>{
        preview.innerHTML = '';
        const img = document.createElement('img');
        img.src = reader.result;
        preview.appendChild(img);
      };
      reader.readAsDataURL(file);
    });

    // validation helpers
    function isValidEmail(v){
      return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v);
    }
    function isValidPhone(v){
      return /^[\+\w][\w\-\s]{3,}$/.test(v);
    }
    function isPositiveInteger(v){
      return /^\d+$/.test(v) && parseInt(v,10) > 0;
    }

    // new field-specific regex rules (added + original)
    const rxName = /^[A-Za-zÃ€-Ã–Ã˜-Ã¶Ã¸-Ã¿'\- ]{2,}$/; // letters, spaces, hyphen, apostrophe (supports accents)
    const rxShip = /^[A-Za-z0-9 '\-]{2,}$/; // ship: alnum, space, hyphen, apostrophe
    const rxReg  = /^[A-Za-z0-9\-]{2,}$/; // registry id: alnum + hyphen
    const rxRegion = /^[A-Za-z0-9,\- ()]{2,}$/; // region: allow commas, parens, spaces

    // === ADDED REGEX / CHECKS ===
    // Planet name must contain at least one digit and at least one vowel (simple intersection)
    // allow letters, digits, spaces, hyphen (min 2 chars)
    const rxPlanetComplex = /^(?=.{2,}$)(?=.*\d)(?=.*[AEIOUaeiou])[A-Za-z0-9 \-]+$/;

    // Antenna count must be a positive even integer (no leading spaces)
    // We'll validate numerically as well as via regex for digit-only
    const rxDigitsOnly = /^\d+$/;

    // Alien ID strict pattern: 3 uppercase letters - 2 uppercase letters _ 4 digits @UFO
    const rxAlienId = /^[A-Z]{3}-[A-Z]{2}_[0-9]{4}@UFO$/;

    // Favorite human phrase must include punctuation or an emoji.
    // Use Unicode property escapes: \p{P} = punctuation, \p{Emoji} may be supported in modern engines.
    // Use a combined check with the 'u' flag. Fallback: punctuation as minimal requirement.
    const rxEmojiOrPunct = /(\p{P}|\p{Emoji})/u;

    // Landing date: we'll compare to today's date and disallow dates strictly before today.
    function isDateNotPast(dateStr){
      if(!dateStr) return false;
      const chosen = new Date(dateStr);
      const now = new Date();
      // normalize both to yyyy-mm-dd midnight to compare only date part
      const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
      const chosenDate = new Date(chosen.getFullYear(), chosen.getMonth(), chosen.getDate());
      return chosenDate >= today;
    }

    // enhanced validation
    function validate(fd){
      // fullname
      const fn = (fd.get('fullname')||'').trim();
      if(!fn) return 'Full name required.';
      if(!rxName.test(fn)) return 'Full name should contain only letters, spaces, hyphen or apostrophe (min 2 chars).';

      // contact
      const ct = fd.get('contactType') || '';
      if(!ct) return 'Please choose a contact method.';
      const cv = (fd.get('contactValue')||'').trim();
      if(ct && !cv) return 'Please provide the contact detail.';
      if(ct === 'email' && !isValidEmail(cv)) return 'Please provide a valid email (e.g. commander@alienism.space).';
      if(ct === 'phone' && !isValidPhone(cv)) return 'Please provide a valid contact (e.g. +ALIEN-0000 or +123456).';

      // planet
      const pl = fd.get('planet') || '';
      if(!pl) return 'Planet of origin required.';
      if(pl === 'Other'){
        const op = (fd.get('otherPlanet')||'').trim();
        if(!op) return 'Please specify planet.';
        if(op.length < 2) return 'Planet name too short.';
      }

      // new: planetNameComplex (if provided) must contain digit + vowel
      const pComplex = (fd.get('planetNameComplex')||'').trim();
      if(pComplex){
        if(!rxPlanetComplex.test(pComplex)) return 'Planet name must be 2+ chars, contain at least one digit and one vowel (A/E/I/O/U).';
      }

      // region: optional but if provided must be reasonable
      const rg = (fd.get('region')||'').trim();
      if(rg && !rxRegion.test(rg)) return 'Region should use letters, numbers, commas or parentheses only.';

      // purpose
      const ps = fd.get('purpose') || '';
      if(!ps) return 'Purpose required.';
      if(ps === 'Other'){
        const it = (fd.get('intent')||'').trim();
        if(!it) return 'Please describe your purpose in the message.';
        if(it.length < 6) return 'Purpose description should be at least 6 characters.';
      }

      // ship
      const ship = (fd.get('ship')||'').trim();
      if(ship && !rxShip.test(ship)) return 'Ship name may include letters, numbers, spaces, hyphen (2+ chars).';

      // registry
      const reg = (fd.get('reg')||'').trim();
      if(!reg) return 'Ship registry ID required.';
      if(!rxReg.test(reg)) return 'Registry ID should be alphanumeric, may include hyphens (2+ chars).';

      // crew: optional but if present must be positive integer > 0
      const crewVal = (fd.get('crew')||'').trim();
      if(crewVal && !isPositiveInteger(crewVal)) return 'Crew size must be a positive whole number.';

      // === Antenna count validation (even numbers only) ===
      const antenna = (fd.get('antennaCount')||'').trim();
      if(antenna){
        if(!rxDigitsOnly.test(antenna)) return 'Antenna count must be numeric.';
        const n = parseInt(antenna, 10);
        if(n <= 0) return 'Antenna count must be positive.';
        if(n % 2 !== 0) return 'Antenna count must be an even number.';
      }

      // === Alien ID validation ===
      const aid = (fd.get('alienId')||'').trim();
      if(aid){
        if(!rxAlienId.test(aid)) return 'Alien ID must match format: ZOR-XY_9999@UFO (uppercase exact).';
      } else {
        return 'Alien ID required.';
      }

      // === Favorite human phrase (emoji or punctuation) ===
      const phrase = (fd.get('favPhrase')||'').trim();
      if(!phrase) return 'Favorite human phrase required.';
      try {
        if(!rxEmojiOrPunct.test(phrase)) return 'Phrase must include punctuation (e.g. . , ! ?) or an emoji.';
      } catch(e){
        // fallback for older engines: require punctuation only
        if(!/[\p{P}]/u.test(phrase)) return 'Phrase must include punctuation (e.g. . , ! ?) or an emoji.';
      }

      // === Landing date validation (cannot be in the past) ===
      const landing = (fd.get('landingDate')||'').trim();
      if(!landing) return 'Please provide a landing date.';
      if(!isDateNotPast(landing)) return 'Landing date cannot be in the past.';

      // Beacon frequency: optional but numeric if present
      const bf = (fd.get('beaconFreq')||'').trim();
      if(bf && !rxDigitsOnly.test(bf)) return 'Beacon frequency must be numeric (Hz).';

      // photo must be uploaded
      if(!photo || !photo.files || photo.files.length === 0) return 'Please upload a photo of the ship/identity.';

      return '';
    }

    // show a green banner for success and fade after 3s
    function showSuccessBanner(text){
      successBanner.textContent = text;
      successBanner.classList.add('show');
      successBanner.setAttribute('aria-hidden', 'false');
      setTimeout(()=>{
        successBanner.classList.remove('show');
        successBanner.setAttribute('aria-hidden', 'true');
      }, 3000);
    }

    form.addEventListener('submit', (e)=>{
      e.preventDefault(); status.textContent='';
      const fd = new FormData(form);
      const err = validate(fd);
      if(err){ status.textContent = err; return; }

      const payload = Object.fromEntries(fd.entries());
      console.log('Manifest â†’', payload);

      // show transmitting then success banner
      status.textContent = 'Transmitting manifest...';
      setTimeout(()=>{
        const name = payload.fullname || 'Traveler';
        // show green banner
        showSuccessBanner(`Successfully registered, ${name}. Thank you.`);
        // reset form and UI
        form.reset(); preview.textContent = 'No photo uploaded';
        otherPurposeMsg.classList.add('hidden'); otherPlanetField.classList.add('hidden');
        document.getElementById('fullname').focus();
      },700);
    });
  </script>
</body>
</html>
